>**时间序列的三种分解模型：**  
>
>1.**加法模型**  
>    *  $y_t = T_t + S_t + C_t + R_t$  
>
>2.**乘法模型**  
>    *  $y_t = T_t \cdot S_t \cdot C_t \cdot R_t$  
>
>3.**混合模型**  
>    *  $y_t = T_t \cdot S_t + R_t$  
>    *  $y_t = S_t + T_t \cdot C_t \cdot R_t$  
>
>**T_t表示趋势项**  
>**S_t表示季节项**  
>**C_t表示循环项**  
>**R_t表示随机项**

---

>1. $y_t$代表你正在研究或观测的变量，在t时间点的值。  
>2. $T_t$代表趋势， $S_t$ 代表季节的影响， $C_t$ 代表更大的影响。  
>  具体来说， $S_t$ 代表季节，时间范围在1年之内， $C_t$ 代表更大兴衰周期，
>  比如市场的繁荣与萧条，且没有固定的规律
>3. 简单来说， $R_t$ 代表去除趋势，季节性，循环，这三个系统性部分之后，剩下的一切。
>   相当于 **“噪音”**， **“杂声”** 。

---

>这套把系统分成：T，S， C， R 的方法是一个经典且高度简化的框架  
>它之所以被广泛使用，并不是他有多完美  
>而是它在 **简洁性** 和 **有效性** 之间取得了绝佳的平衡  
>这个模型背后的哲学思想是 **奥卡姆剃刀原理** ： **“如无必要，勿增实体”**  
>比如一个老板，最关心的就是：  
>1.销售额长期是出于增长还是下降  
>2.是否需要为购物季囤货  
>3.目前处于行业的景气周期还是衰退周期  
>
>这就是前3项直击核心的建模，最后再加上一个随即项即可。

---

>当季节性的波动振幅是**恒定的**时，用加法  
>当季节性的波动与时间序列**成正比**时，用乘法  
>混合模型则同时考虑两种情况

---

>移动平均法，就是通过选取窗口算平均值，来使之前的数据更平滑。

---

>**简单指数平滑法**  
>就是通过给最新的观测值和上一次的预期值加上权重  
>来让预期更加准确  
>预期值（t+1期） = α x 实际值（t期） + （1-α） x 预期值（t期）  
>通过α来调节对新信息的灵敏度

---

>**霍特线性趋势模型**  
>水平平滑方程： $l_t = α \cdot x_t + (1-α) \cdot (l_{t-1} + b_{t-1})$  
> 1. $l_t$ ：更新后的“当前水平”  
> 2. $α \cdot x_t$ : 考虑实际观测值  
> 3. $(1-α) \cdot (l_{t-1} + b_{t-1})$ : 考虑“上期水平+上期趋势”的预测
>
>趋势平滑方程： $b_t = β \cdot (l_t - l_{t-1}) + (1-β) \cdot b_{t-1}$  
>1. $b_t$ : 更新后的趋势  
>2. $β \cdot (l_t - l_{t-1})$ : 最新观察到的增长  
>3. $(1-β) \cdot b_{t-1}$ : 之前的趋势  
>  
>预测方程： 预测值 = $l_t + h \cdot b_t$  
>1. $l_t$ : 当前位置  
>2. $h \cdot b_t$ : 速度 $\cdot$ 时间 = 距离  
>  
>对于给出的数据,  
>先用每段数据算出每段的l和b  
>最后算预测值的时候，  
>h的值是根据原始数据和要预测的数据来确定的  
>比如，你知道1，2，3月  
>要预测4月，则h为1  
>要预测5月，则h为2

---

**阻尼趋势模型**  
三个方程的变化：  
1.  水平方程：  
    *    霍特： $l_t = α \cdot x_t + (1-α) \cdot (l_{t-1} + b_{t-1})$  
    *    阻尼： $l_t = α \cdot x_t + (1-α) \cdot (l_{t-1} + φ \cdot b_{t-1})$  
    *    趋势项 $b_{t-1}$ 前面多了个φ，表示趋势被“打折”了  
2.  趋势方程：  
    *    霍特： $b_t = β \cdot (l_t - l_{t-1}) + (1-β) \cdot b_{t-1}$  
    *    阻尼： $b_t = β \cdot (l_t - l_{t-1}) + (1-β) \cdot φ \cdot b_{t-1}$    
    *    历史趋势 $b_{t-1}$ 也被φ“打折”  
3.  预测方程的巨大变化：  
    *    霍特：预测值 = $l_t + h \cdot b_t$  
    *    阻尼：预测值 = $l_t + (φ + φ^2 + ... + φ^h) \cdot b_t$  
4.  阻尼系数φ的作用就像“摩檫力”，  
    *    当φ = 1 时，没有摩檫，也就是霍特模型

---

**简单季节性模型**  
1.    水平平滑方程：
     $l_t = α \cdot (x_t - s_{t-m}) + (1-α) \cdot l_{t-1}$  
      *    $l_t$ 为当前时间点t的“基准水平”（剔除季节性影响）  
      *    $x_t$ ：t时刻的实际观测值  
      *    $s_{t-m}$ : 上一周期中同意季节的季节性影响因子  
      *   $(x_t - s_{t-m})$ : 剔除季节性影响  
      *   $l_{t-1}$ :上一个时间点的基准水平  
2.    季节平滑方程：
     $s_t = γ(x_t - l_{t-1}) + (1-γ)s_{t-m}$
      *   $x_t$ ：t时刻的实际观测值
      *   $l_{t-1}$ : 上个月的基准水平
      *   $(x_t - l_{t-1})$ : 季节性影响
      *   $s_{t-m}$ : 上个周期的季节性影响
      *   $γ$ : 季节性平滑参数(权重)   
3.    预测方程：

```math
\hat{X}_{t+h} = l_t + s_{t+h-m(k+1)}, \quad k = \lfloor \frac{h-1}{m} \rfloor
```

- 未来测试值 = 当前基准水平 + 对应未来的季节性影响  
- $s_{t+h-m(k+1)}$ : 找到我们需要的那个未来月份的、最近一次计算出的季节性因子
4.   在应用模型的时候：
        *   计算初始的 $l_0$ (通常是第一个周期的平均值)  
        *   计算初始的季节因子： $s_1$ , $s_2$ , ... , $s_m$
        *   计算第一个周期每个时间点与 $l_0$ 的差(或使用更复杂的初始化方法)  
        *   比如现在有24个月的数据
        *   用前12个月的来算出 $l_0$ 和 一大堆 $s$
        *   从第13个月开始，逐月更新 $l_t$ 和 $s_t$

---

**霍特-温特季节性加法模型**  
>我是以为经验丰富的老裁缝  
>在给一个长身体的孩子年复一年的做合身的衣服  
>1.有基础身高（水平）  
>2.每年都在长高（趋势）  
>3.夏天穿短袖，冬天穿棉袄（季节性）
>- $l_t$ :孩子在 $t$ 时刻的基础身高
>- $b_t$ : $t$ 时刻的生长速度
>- $s_t$ : $t$ 时刻的季节性调整
>- $x_t$ :最后的衣服总长


1.   水平平滑方程-更新"基础身高"

```math
l_t = α(x_t - s_{t-m}) + (1-α)(l_{t-1} + b_{t-1})
```
---
> - 我怎么得到现在的基础身高呢？  
> - 应该综合现在的和以前的  
> - $x_t$ 是当前测量值(总衣长）
> - 要让这个数据减去季节性影响（ $s$ 由以前的数据得到）
> - 得到对当前**基础身高**的估算后乘以权重
> - $l_{t-1}$ 是昨天的基础身高
> - $b_{t-1}$ 是昨天的生长速度
> - 相加再乘以它的权重

2.   趋势平滑方程-更新“生长速度”

```math
b_t = β(l_t - l_{t-1}) + (1-β)b_{t-1}
```
---
> - 左边是最新的生长证据，乘以权重
> - 右边是昨天的生长速度

3.   季节平滑方程-更新“季节性调整”

```math
s_t = γ(x_t - l_{t-1} - b_{t-1} ) + (1 - γ)s_{t-m} 
```
---
> - $l_{t-1} + b{t-1}$ ：是昨天预测的不穿棉袄时的身高
> - $x_t$ : 是今天测的总衣长
> - $s_{t-m}$ : 去年的棉袄尺寸

4.预测方程-预测未来的衣长  

```math
\hat{x}_{t+h} = l_t + h \cdot b_t + s_{t+h-m(k+1)}
```
---
> - $l_t$ : 最新的基础身高
> - $h \cdot b_t$ : 最新的增高量
> - $s_{t+h-m(k+1)}$ : 距离预测时间点最近的季节性影响

---

### 霍特-温特季节性乘法模型  

```math
\begin{cases}
L_t = \alpha \frac{x_t}{s_{t-m}} + (1-\alpha)(L_{t-1} + b_{t-1}) & \text{(水平平滑方程)} \\
b_t = \beta (L_t - L_{t-1}) + (1-\beta)b_{t-1} & \text{(趋势平滑方程)} \\
s_t = \gamma \frac{x_t}{L_{t-1} + b_{t-1}} + (1-\gamma)s_{t-m} & \text{(季节平滑方程)} \\
\hat{x}_{t+h} = (L_t + h b_t)s_{t+h-m(k+1)}, \quad k = \left\lfloor \frac{h-1}{m} \right\rfloor & \text{(预测方程)}
\end{cases}
```

1. 加法模型：夏天比冬天多卖1000个冰激凌（固定差值）
2. 乘法模型：夏天的销量是冬天的3倍（比例关系）
---
1.对于水平平滑方程：  
```math
l_t = \alpha \frac{x_t}{s_{t-m}} + (1 - \alpha)(l_{t-1} + b_{t-1})
```

   *   $x_t$ 通过除以去年同期的季节因子来去季节化  
   *   $l_{t-1} + b_{t-1}$ 和之前的一样是，昨天的水平和昨天的趋势


2.对于趋势平滑方程：
```math
b_t = \beta (l_t - l_{t-1}) + (1 - \beta)b_{t-1}
```

   *   更新增长速度（和加法模型完全一样）

3.对于季节平滑方程：
```math
s_t = \gamma \frac{x_t}{l_{t-1} + b_{t-1}} + (1 - \gamma )s_{t-m}
```

   *   通过用 $x_t$ 除以 $l_{t-1} + b_{t-1}$ 来得到如今的季节性影响的demo
   *   再用权重结合上一周期的季节性影响

4.对于预测方程：
```math
\hat{x}_{t+h} = (l_{t} + h b_{t}) \cdot s_{t+h-m(k+1)}
```

   *   基础加预测**乘以**季节性影响


### 霍特-温特季节性阻尼趋势模型
```math
\begin{cases}
l_t = \alpha \frac{x_t}{s_{t-m}} + (1 - \alpha)(l_{t-1} + \phi b_{t-1})  \\
b_t = \beta (l_t - l_{t-1}) + (1 - \beta) \phi b_{t-1}  \\
s_t = \gamma \frac{x_t}{l_{t-1} + \phi b_{t-1} } + (1 - \gamma) s_{t-m}   \\  
\hat{x}_{t+h} = (l_{t} + ( \phi + \phi ^2 + ··· + \phi ^h)b_{t})s_{t+h-m(k+1)}, k = [\frac{h-1}{m}] \\
\end{cases}
```

- 其实就是在**霍特-温特季节性趋势模型**的基础上
- 在每个b前面加上阻尼系数

---

### 时间序列的平稳性  

- 平稳时间序列是**性质与观测时间无关**的序列
- 具有趋势或季节性的时间序列不是平稳的
- 白噪声序列是平稳的
  *   就像电视没信号时的“沙沙”声
  *   没有趋势
  *   没有季节性
  *   完全在一个恒定的水平和恒定的波动范围内进行

- 具有周期性行为（但无趋势，无季节性）的时间序列是平稳的
  *   周期性：有周期，但周期长度不固定，不可预测

**若时间序列{ $x_t$ } 满足一下三个条件：**
1. E( $x_t$ ) = E( $x_{t-s}$ ) = u  (均值为固定常数）  
2. Var( $x_t$ ) = Var( $x_{t-s}$ ) = $\sigma ^2$   (方差存在且为常数）
3. Cov( $x_t$ , $x_{t-s}$ ) = $\gamma_{s}$   (协方差只和间隔s有关，与t无关）
    

